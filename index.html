<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Pokédex — Mockup</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* small helpers for demo */
      .type-chip {
        @apply inline-flex items-center px-3 py-1 rounded-full text-sm font-medium;
      }
      .card-shadow {
        box-shadow: 0 6px 18px rgba(18, 24, 33, 0.06);
      }
    </style>
  </head>
  <body class="bg-gray-50 text-slate-900 antialiased">
    <main class="max-w-4xl mx-auto px-4 py-6">
      <!-- Header -->
      <header class="flex items-center justify-between gap-4 mb-6">
        <div class="flex items-center gap-3">
          <img
            src="/mnt/data/A_2D_digital_design_showcases_a_Pokémon_mobile_app.png"
            alt="logo"
            class="w-10 h-10 rounded-full object-cover ring-2 ring-white shadow-sm"
          />
          <h1 class="text-2xl font-extrabold tracking-tight">Pokémon</h1>
        </div>

        <div class="flex items-center gap-2">
          <button
            id="exportCsvBtn"
            class="px-3 py-2 bg-yellow-400 text-slate-900 rounded-lg font-medium shadow-sm hover:brightness-95"
          >
            Export CSV
          </button>

          <div
            class="inline-flex items-center gap-2 bg-white px-2 py-1 rounded-lg card-shadow"
          >
            <span
              id="caughtCount"
              class="px-3 py-1 rounded-full bg-green-100 text-green-800 font-semibold"
              >0</span
            >
            <span class="text-sm text-slate-600">Caught</span>
          </div>

          <button
            id="toggleViewBtn"
            title="Toggle grid / table"
            class="p-2 bg-white rounded-lg card-shadow"
          >
            <svg
              id="toggleIcon"
              class="w-5 h-5 text-slate-700"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <rect x="3" y="3" width="8" height="8" rx="1.5"></rect>
              <rect x="13" y="3" width="8" height="8" rx="1.5"></rect>
              <rect x="3" y="13" width="8" height="8" rx="1.5"></rect>
              <rect x="13" y="13" width="8" height="8" rx="1.5"></rect>
            </svg>
          </button>
        </div>
      </header>

      <!-- Search & filters -->
      <section class="space-y-3 mb-6">
        <div class="relative">
          <input
            id="searchInput"
            type="search"
            placeholder="Search Pokémon"
            class="w-full rounded-xl px-4 py-3 bg-white card-shadow placeholder-slate-400 outline-none"
          />
          <svg
            class="w-5 h-5 absolute right-4 top-3.5 text-slate-400"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
          >
            <path d="M21 21l-4.35-4.35"></path>
            <circle cx="11" cy="11" r="6"></circle>
          </svg>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <select
            id="typeFilter"
            class="rounded-xl px-4 py-3 bg-white card-shadow outline-none"
          >
            <option value="">All types</option>
            <option value="grass">Grass</option>
            <option value="poison">Poison</option>
            <option value="fire">Fire</option>
            <option value="flying">Flying</option>
          </select>

          <select
            id="sortSelect"
            class="rounded-xl px-4 py-3 bg-white card-shadow outline-none"
          >
            <option value="id">Sort: ID</option>
            <option value="name">Sort: Name</option>
            <option value="height">Sort: Height</option>
            <option value="timestamp">Sort: Added (newest)</option>
          </select>
        </div>
      </section>

      <!-- Grid / Table container -->
      <section id="contentArea" class="mb-12">
        <!-- Grid view (default) -->
        <div id="gridView" class="grid grid-cols-2 sm:grid-cols-3 gap-4">
          <!-- Cards injected by JS -->
        </div>

        <!-- Table view (hidden by default) -->
        <div
          id="tableView"
          class="hidden bg-white rounded-xl card-shadow overflow-x-auto"
        >
          <table class="min-w-full text-left">
            <thead class="bg-slate-100">
              <tr>
                <th class="px-4 py-3">Name</th>
                <th class="px-4 py-3">Types</th>
                <th class="px-4 py-3">Height</th>
                <th class="px-4 py-3">Added</th>
                <th class="px-4 py-3">Actions</th>
              </tr>
            </thead>
            <tbody id="tableBody" class="divide-y"></tbody>
          </table>
        </div>
      </section>

      <!-- Progress / Analytics small -->
      <section class="mb-8 grid sm:grid-cols-3 gap-3">
        <div class="bg-white rounded-xl p-4 card-shadow">
          <div class="text-sm text-slate-500">Total Pokémon</div>
          <div id="totalCount" class="text-2xl font-bold">0</div>
        </div>
        <div class="bg-white rounded-xl p-4 card-shadow">
          <div class="text-sm text-slate-500">Caught</div>
          <div id="caughtStat" class="text-2xl font-bold">0</div>
        </div>
        <div class="bg-white rounded-xl p-4 card-shadow">
          <div class="text-sm text-slate-500">Completion</div>
          <div id="completion" class="text-2xl font-bold">0%</div>
        </div>
      </section>

      <footer class="text-center text-sm text-slate-500 pb-10">
        Demo mockup • offline-friendly structure • Tailwind
      </footer>
    </main>

    <!-- Notes Modal -->
    <div
      id="notesModal"
      class="fixed inset-0 z-40 hidden items-center justify-center bg-black/40"
    >
      <div class="bg-white rounded-xl w-11/12 max-w-xl p-6">
        <h3 class="text-lg font-semibold mb-3">Edit Note</h3>
        <textarea
          id="noteText"
          rows="6"
          class="w-full rounded-md px-3 py-2 border border-slate-200"
        ></textarea>
        <div class="mt-4 flex justify-end gap-2">
          <button
            id="closeNoteBtn"
            class="px-4 py-2 rounded-lg bg-white border"
          >
            Cancel
          </button>
          <button
            id="saveNoteBtn"
            class="px-4 py-2 rounded-lg bg-blue-600 text-white"
          >
            Save
          </button>
        </div>
      </div>
    </div>

    <script>
      // Sample data (in real app you'd fetch from PokéAPI)
      const POKEMONS = [
        {
          id: 1,
          name: "Bulbasaur",
          types: ["grass", "poison"],
          height: 7,
          weight: 69,
          caught: true,
          timestamp: "2025-11-14T10:12:00Z",
          note: "Found near Viridian Forest",
        },
        {
          id: 2,
          name: "Ivysaur",
          types: ["grass", "poison"],
          height: 10,
          weight: 130,
          caught: true,
          timestamp: "2025-11-15T14:07:00Z",
          note: "",
        },
        {
          id: 3,
          name: "Venusaur",
          types: ["grass", "poison"],
          height: 20,
          weight: 1000,
          caught: false,
          timestamp: null,
          note: "",
        },
        {
          id: 6,
          name: "Charizard",
          types: ["fire", "flying"],
          height: 17,
          weight: 905,
          caught: false,
          timestamp: null,
          note: "",
        },
      ];

      // Use the uploaded image as card art for demo; in prod use official artwork URLs
      const ART_URL =
        "/mnt/data/A_2D_digital_design_showcases_a_Pokémon_mobile_app.png";

      // Elements
      const gridView = document.getElementById("gridView");
      const tableView = document.getElementById("tableView");
      const tableBody = document.getElementById("tableBody");
      const caughtCountEl = document.getElementById("caughtCount");
      const caughtStat = document.getElementById("caughtStat");
      const totalCountEl = document.getElementById("totalCount");
      const completionEl = document.getElementById("completion");
      const toggleViewBtn = document.getElementById("toggleViewBtn");
      const toggleIcon = document.getElementById("toggleIcon");
      const searchInput = document.getElementById("searchInput");
      const typeFilter = document.getElementById("typeFilter");
      const sortSelect = document.getElementById("sortSelect");
      const exportCsvBtn = document.getElementById("exportCsvBtn");

      // Notes modal
      const notesModal = document.getElementById("notesModal");
      const noteText = document.getElementById("noteText");
      const closeNoteBtn = document.getElementById("closeNoteBtn");
      const saveNoteBtn = document.getElementById("saveNoteBtn");
      let editingPokemonId = null;

      // State
      let pokemons = JSON.parse(JSON.stringify(POKEMONS)); // clone
      let isGrid = true;

      // Utilities
      function updateStats() {
        const total = pokemons.length;
        const caught = pokemons.filter((p) => p.caught).length;
        totalCountEl.textContent = total;
        caughtCountEl.textContent = caught;
        caughtStat.textContent = caught;
        completionEl.textContent = Math.round((caught / total) * 100) + "%";
      }

      function formatDate(ts) {
        if (!ts) return "-";
        const d = new Date(ts);
        return d.toLocaleString();
      }

      function createTypeChip(type) {
        const el = document.createElement("span");
        el.className =
          "type-chip mr-2 " +
          (type === "fire"
            ? "bg-orange-100 text-orange-800"
            : type === "grass"
              ? "bg-emerald-100 text-emerald-800"
              : type === "poison"
                ? "bg-violet-100 text-violet-800"
                : "bg-slate-100 text-slate-800");
        el.textContent = type[0].toUpperCase() + type.slice(1);
        return el;
      }

      function renderGrid(items) {
        gridView.innerHTML = "";
        items.forEach((p) => {
          const card = document.createElement("article");
          card.className =
            "bg-white rounded-xl overflow-hidden p-3 card-shadow relative";

          // caught badge
          if (p.caught) {
            const badge = document.createElement("div");
            badge.className =
              "absolute right-3 top-3 bg-white/90 rounded-full p-1 shadow-sm";
            badge.innerHTML =
              '<svg class="w-5 h-5 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M20 6L9 17l-5-5"></path></svg>';
            card.appendChild(badge);
          }

          const imgWrap = document.createElement("div");
          imgWrap.className =
            "w-full h-28 flex items-center justify-center mb-3";
          const img = document.createElement("img");
          img.className = "max-h-24 object-contain";
          img.src = ART_URL;
          img.alt = p.name;
          imgWrap.appendChild(img);
          card.appendChild(imgWrap);

          const name = document.createElement("h3");
          name.className = "text-center font-semibold text-lg mb-2";
          name.textContent = p.name;
          card.appendChild(name);

          const chips = document.createElement("div");
          chips.className = "flex items-center justify-center mb-3";
          p.types.forEach((t) => chips.appendChild(createTypeChip(t)));
          card.appendChild(chips);

          const actions = document.createElement("div");
          actions.className = "flex items-center justify-between gap-2";
          // caught toggle
          const toggle = document.createElement("button");
          toggle.className = "px-3 py-1 rounded-lg border text-sm";
          toggle.textContent = p.caught ? "Remove" : "Catch";
          toggle.onclick = () => {
            p.caught = !p.caught;
            if (p.caught && !p.timestamp)
              p.timestamp = new Date().toISOString();
            if (!p.caught) p.timestamp = null;
            render();
          };
          actions.appendChild(toggle);

          const noteBtn = document.createElement("button");
          noteBtn.className = "px-3 py-1 rounded-lg border text-sm";
          noteBtn.textContent = "Note";
          noteBtn.onclick = () => openNoteModal(p.id);
          actions.appendChild(noteBtn);

          const shareBtn = document.createElement("button");
          shareBtn.className = "px-3 py-1 rounded-lg border text-sm";
          shareBtn.textContent = "Share";
          shareBtn.onclick = () => {
            // small share demo; production should integrate navigator.share if available
            alert("Share stub: " + p.name);
          };
          actions.appendChild(shareBtn);

          card.appendChild(actions);

          gridView.appendChild(card);
        });
      }

      function renderTable(items) {
        tableBody.innerHTML = "";
        items.forEach((p) => {
          const tr = document.createElement("tr");
          tr.className = "odd:bg-white even:bg-slate-50";
          tr.innerHTML = `
          <td class="px-4 py-3 align-top">
            <div class="flex items-center gap-3">
              <img src="${ART_URL}" alt="${p.name}" class="w-14 h-14 rounded-md object-contain"/>
              <div>
                <div class="font-semibold">${p.name}</div>
                <div class="text-xs text-slate-500">#${p.id}</div>
              </div>
            </div>
          </td>
          <td class="px-4 py-3 align-top">${p.types.map((t) => `<span class="inline-block mr-2 px-2 py-1 rounded-full text-xs bg-slate-100">${t}</span>`).join("")}</td>
          <td class="px-4 py-3 align-top">${p.height} dm</td>
          <td class="px-4 py-3 align-top">${p.timestamp ? new Date(p.timestamp).toLocaleString() : "-"}</td>
          <td class="px-4 py-3 align-top">
            <div class="flex gap-2">
              <button class="px-3 py-1 text-sm rounded-lg border" onclick="toggleCatch(${p.id})">${p.caught ? "Remove" : "Catch"}</button>
              <button class="px-3 py-1 text-sm rounded-lg border" onclick="openNoteModal(${p.id})">Note</button>
              <button class="px-3 py-1 text-sm rounded-lg border" onclick="shareStub(${p.id})">Share</button>
            </div>
          </td>
        `;
          tableBody.appendChild(tr);
        });
      }

      // render pipeline with filters / search
      function getFiltered() {
        const q = searchInput.value.trim().toLowerCase();
        const type = typeFilter.value;
        const sort = sortSelect.value;

        let items = pokemons.filter((p) => {
          if (q && !p.name.toLowerCase().includes(q)) return false;
          if (type && !p.types.includes(type)) return false;
          return true;
        });

        items.sort((a, b) => {
          if (sort === "name") return a.name.localeCompare(b.name);
          if (sort === "height") return (a.height || 0) - (b.height || 0);
          if (sort === "timestamp")
            return (b.timestamp || 0) - (a.timestamp || 0);
          return (a.id || 0) - (b.id || 0);
        });

        return items;
      }

      function render() {
        updateStats();
        const items = getFiltered();
        if (isGrid) {
          gridView.classList.remove("hidden");
          tableView.classList.add("hidden");
          renderGrid(items);
        } else {
          gridView.classList.add("hidden");
          tableView.classList.remove("hidden");
          renderTable(items);
        }
      }

      // small helpers for global onclicks used in table markup
      window.toggleCatch = function (id) {
        const p = pokemons.find((x) => x.id === id);
        if (!p) return;
        p.caught = !p.caught;
        if (p.caught && !p.timestamp) p.timestamp = new Date().toISOString();
        if (!p.caught) p.timestamp = null;
        render();
      };

      window.openNoteModal = function (id) {
        const p = pokemons.find((x) => x.id === id);
        if (!p) return;
        editingPokemonId = id;
        noteText.value = p.note || "";
        notesModal.classList.remove("hidden");
        notesModal.style.display = "flex";
      };

      window.shareStub = function (id) {
        const p = pokemons.find((x) => x.id === id);
        alert("Share stub for " + p.name);
      };

      // modal listeners
      closeNoteBtn.addEventListener("click", () => {
        notesModal.classList.add("hidden");
        notesModal.style.display = "none";
      });

      saveNoteBtn.addEventListener("click", () => {
        const p = pokemons.find((x) => x.id === editingPokemonId);
        if (!p) return;
        p.note = noteText.value;
        notesModal.classList.add("hidden");
        notesModal.style.display = "none";
        render();
      });

      // toggle view
      toggleViewBtn.addEventListener("click", () => {
        isGrid = !isGrid;
        // swap icon for hint (keeps simple)
        toggleIcon.innerHTML = isGrid
          ? '<rect x=\"3\" y=\"3\" width=\"8\" height=\"8\" rx=\"1.5\"></rect><rect x=\"13\" y=\"3\" width=\"8\" height=\"8\" rx=\"1.5\"></rect><rect x=\"3\" y=\"13\" width=\"8\" height=\"8\" rx=\"1.5\"></rect><rect x=\"13\" y=\"13\" width=\"8\" height=\"8\" rx=\"1.5\"></rect>'
          : '<rect x=\"3\" y=\"4\" width=\"18\" height=\"3\" rx=\"1.5\"></rect><rect x=\"3\" y=\"10.5\" width=\"18\" height=\"3\" rx=\"1.5\"></rect><rect x=\"3\" y=\"17\" width=\"18\" height=\"3\" rx=\"1.5\"></rect>';
        render();
      });

      // filter bindings
      [searchInput, typeFilter, sortSelect].forEach((el) =>
        el.addEventListener("input", render)
      );

      // export CSV button
      exportCsvBtn.addEventListener("click", () => {
        // export only caught pokemons
        const rows = pokemons
          .filter((p) => p.caught)
          .map((p) => ({
            id: p.id,
            name: p.name,
            types: p.types.join("|"),
            height: p.height,
            weight: p.weight,
            timestamp: p.timestamp || "",
          }));
        if (!rows.length) {
          alert("No caught Pokémon to export");
          return;
        }
        const headers = [
          "id",
          "name",
          "types",
          "height",
          "weight",
          "timestamp",
        ];
        const csv = [headers.join(",")]
          .concat(
            rows.map((r) =>
              headers
                .map((h) => {
                  // simple CSV escaping
                  const v = (r[h] ?? "").toString().replace(/"/g, '""');
                  return `"${v}"`;
                })
                .join(",")
            )
          )
          .join("\\n");

        const blob = new Blob([csv], { type: "text/csv" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "pokedex_export.csv";
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });

      // initial render
      render();
    </script>
  </body>
</html>
